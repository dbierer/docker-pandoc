# Pandoc Docker container with XeLaTeX

## This fork is maintained by Cal Evans <cal@calevans.com>

## License: MIT
The code unique to this fork is released under the MIT license. This does not apply to any additional code used by the project. All programs used in the project are to the best of my knowledge open source. They all are covered by different licenses. None of the licenses in any of the programs used cover the books that are generated by the project. Those belong to their respective copyright holder. If you plan on distributing this project, I suggest you carefully investigate all programs being installed and their respective licenses to make sure that you understand them before you attempt to distribute.

# What it does

This project will take a Markdown formatted book project and create :

- HTML
- PDF
- EPUB
- MOBI (Kindle)

# Build

To build this container, I use the following in this repo's root.

```
$ docker build --force-rm -squash --tag buildbook ./
```

# Requirements
For this project to work, several requirements  must be met.

## Directories
The following directories are required to be present in the root directory.

- manuscript
- config
- pandoc *

  * The pandoc directory is optional. It holds a couple of specific pandoc templates. If the templates do not exist, the program will proceed without them.

## Files
The following files are required for the system to operate.

- `book.yaml`
All the info about the book that is necessary to create the various files but cannot be derived from the other files. This is divided into three sections, `variables`, `book` and `manuscript`Here is a sample:
    
```
---
variables:
  FINALNAMEROOT: life_badges_by_cal_evans
  VERSION: 1.0.2
  COVERGRAPHIC: cover.png
book:
  title:
    type: main
    text: Life Badges
  creator:
    role: author
    text: Cal Evans
  publisher:  E.I.C.C., Inc.
  rights: Â© 2017 E.I.C.C., Inc. All Rights Reserved
  language: en_US.UTF-8
manuscript:
  - foreword.md
  - intro.md
  - learn.md
  - humility.md
  - be_a_better_person.md
  - be_a_better_developer.md
  - create_something.md
  - help_someone.md
  - greatness.md
  - leadership.md
  - inspire.md
  - conclusion.md
  - 99.md  
...
```
`variables` is dumped into a file and sourced by the script. The variables at that point are available in the script.
`book` is dumped into `book.yaml` and is used in the creation of the epub file.
`manuscript` is a list of the files in the order they should appear. These are the file names as they appear in the `manuscript/` directory.

- `manuscript/title.md`
This is the title page of the book. It can be MD and include HTML. 


- `pandoc/toc.html`
**OPTIONAL** If you are familiar with pandoc and you want to control the text surrounding the table of contents that is generated for the PDF, you can place a file in the `pandoc` directory named `toc.html`. It is up to you to understand what can go in this file. Here is a sample:
```
<div class="pagebreak">
<h1>Table of Contents</h1>
$toc$
</div>
```

-- `pandoc/copyright.html`
**OPTIONAL** This is not a pandoc specific file, it is just the file that will be used as a template for your copyright page if it exists. If it exists, we will try to replace `<!--DATEPUBLISHED-->` and `<!--VERSION-->` if they exist. Use this file to put any boilerplate you want on the copyright page. 

The `variables` section will be processed and a files containing `KEY=VALUE` pairs will be created. This will then be sourced so that the values will be available to the script.

The `book` section is what is passed to the EPUB generator. It is parsed and created as a file in the working directory and included in the EBPUB generation process.


# Process
When the container is properly executed, it will run `./buildbook.sh`. This is the starting point. `./builbook.sh` will check to make sure that all necessary files are present. It will then generate the output in all three formats. 


## Linux/macOS
```
$ docker run --rm -v `$PWD`:/data buildbook
```

## Windows
```
docker run --rm -v %cd%:/data buildbook
```

# Version History
- 1.0.0 First Release